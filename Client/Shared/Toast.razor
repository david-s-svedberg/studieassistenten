@* Toast notification component for user feedback *@

@if (visible)
{
    <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11;">
        <div class="toast show @GetToastClass()" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <strong class="me-auto">
                    @if (Type == ToastType.Success)
                    {
                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                    }
                    else if (Type == ToastType.Error)
                    {
                        <i class="bi bi-exclamation-triangle-fill text-danger me-2"></i>
                    }
                    else if (Type == ToastType.Warning)
                    {
                        <i class="bi bi-exclamation-circle-fill text-warning me-2"></i>
                    }
                    else
                    {
                        <i class="bi bi-info-circle-fill text-primary me-2"></i>
                    }
                    @Title
                </strong>
                <small class="text-muted">just now</small>
                <button type="button" class="btn-close" @onclick="Hide" aria-label="Close"></button>
            </div>
            <div class="toast-body">
                @Message
            </div>
        </div>
    </div>
}

@code {
    private bool visible;

    [Parameter] public string Title { get; set; } = "Notification";
    [Parameter] public string Message { get; set; } = "";
    [Parameter] public ToastType Type { get; set; } = ToastType.Info;
    [Parameter] public int DurationMs { get; set; } = 5000;

    public async Task Show()
    {
        visible = true;
        StateHasChanged();

        if (DurationMs > 0)
        {
            await Task.Delay(DurationMs);
            Hide();
        }
    }

    public void Hide()
    {
        visible = false;
        StateHasChanged();
    }

    private string GetToastClass()
    {
        return Type switch
        {
            ToastType.Success => "border-success",
            ToastType.Error => "border-danger",
            ToastType.Warning => "border-warning",
            _ => "border-info"
        };
    }

    public enum ToastType
    {
        Info,
        Success,
        Warning,
        Error
    }
}
